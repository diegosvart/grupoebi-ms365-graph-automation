{
  "permissions": {
    "allow": [
      "Bash(powershell -Command \"Move-Item -Path ''C:\\\\Users\\\\usuario\\\\OneDrive - Cosemar\\\\PM\\\\Definicion plan control y gestión de proyectos\\\\Planner_Import'' -Destination ''C:\\\\Users\\\\usuario\\\\OneDrive - Cosemar\\\\PM\\\\Definicion plan control y gestión de proyectos\\\\Automatizaciones\\\\Planner_Import''\")",
      "Bash(powershell -Command \"Move-Item -Path ''C:\\\\Users\\\\usuario\\\\OneDrive - Cosemar\\\\PM\\\\Definicion plan control y gestión de proyectos\\\\Planner_Import'' -Destination ''C:\\\\Users\\\\usuario\\\\OneDrive - Cosemar\\\\PM\\\\Definicion plan control y gestión de proyectos\\\\Automatizaciones\\\\Planner_Import'' -Force\")",
      "Bash(python -c:*)",
      "Bash(pip install:*)",
      "Bash(python3 -m pip install:*)",
      "Bash(python3:*)",
      "Bash(node --version:*)",
      "Bash(python planner_import.py:*)",
      "Bash(python -m pytest:*)",
      "Bash(start \"\" \"C:\\\\Users\\\\usuario\\\\OneDrive - Cosemar\\\\PM\\\\Automatización_procesos_MsGraph\\\\Planner_Import_script\\\\MANUAL.md\")",
      "Bash(git:*)",
      "Bash(head:*)",
      "Bash(robocopy C:\\\\Users\\\\dmorales\\\\OneDrive - Cosemar\\\\PM\\\\Automatización_procesos_MsGraph\\\\fornado-planner-mcp:*)",
      "Bash(cmd:*)",
      "Bash(tail:*)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && printf \"1\\\\ns\\\\n\" | python planner_import.py --mode delete --filter \"TEST_DELETE\" 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys\nfrom pathlib import Path\nimport os\n\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        # Listar todos los grupos M365 \\(Unified\\)\n        url = f\"{GRAPH_BASE}/groups?$filter=groupTypes/any\\(c:c eq 'Unified'\\)&$select=id,displayName&$top=50\"\n        groups = []\n        while url:\n            r = await client.get\\(url, headers=headers\\)\n            r.raise_for_status\\(\\)\n            data = r.json\\(\\)\n            groups.extend\\(data.get\\(\"value\", []\\)\\)\n            url = data.get\\(\"@odata.nextLink\"\\)\n\n        print\\(f\"Grupos M365 encontrados: {len\\(groups\\)}\\\\n\"\\)\n\n        all_plans = []\n        for g in groups:\n            r = await client.get\\(f\"{GRAPH_BASE}/groups/{g['id']}/planner/plans\", headers=headers\\)\n            if r.status_code != 200:\n                continue\n            plans = r.json\\(\\).get\\(\"value\", []\\)\n            for p in plans:\n                all_plans.append\\({\n                    \"group\": g[\"displayName\"],\n                    \"group_id\": g[\"id\"],\n                    \"plan_id\": p[\"id\"],\n                    \"title\": p.get\\(\"title\", \"\\(sin título\\)\"\\),\n                    \"created\": p.get\\(\"createdDateTime\", \"\"\\)[:10],\n                }\\)\n\n        print\\(f\"Planes encontrados en total: {len\\(all_plans\\)}\\\\n\"\\)\n        print\\(f\"  {'#':<3}  {'Título':<40}  {'Grupo':<30}  {'Creado'}\"\\)\n        print\\(f\"  {'─'*3}  {'─'*40}  {'─'*30}  {'─'*10}\"\\)\n        for i, p in enumerate\\(all_plans, 1\\):\n            print\\(f\"  {i:<3}  {p['title']:<40}  {p['group']:<30}  {p['created']}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\n\nfrom pathlib import Path\nimport os\n\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        url = f\"{GRAPH_BASE}/groups?$filter=groupTypes/any\\(c:c eq 'Unified'\\)&$select=id,displayName&$top=50\"\n        groups = []\n        while url:\n            r = await client.get\\(url, headers=headers\\)\n            r.raise_for_status\\(\\)\n            data = r.json\\(\\)\n            groups.extend\\(data.get\\(\"value\", []\\)\\)\n            url = data.get\\(\"@odata.nextLink\"\\)\n\n        all_plans = []\n        for g in groups:\n            r = await client.get\\(f\"{GRAPH_BASE}/groups/{g['id']}/planner/plans\", headers=headers\\)\n            if r.status_code != 200:\n                continue\n            for p in r.json\\(\\).get\\(\"value\", []\\):\n                all_plans.append\\({\n                    \"group\": g[\"displayName\"],\n                    \"group_id\": g[\"id\"],\n                    \"plan_id\": p[\"id\"],\n                    \"title\": p.get\\(\"title\", \"\\(sin titulo\\)\"\\),\n                    \"created\": p.get\\(\"createdDateTime\", \"\"\\)[:10],\n                }\\)\n\n        print\\(f\"Planes encontrados: {len\\(all_plans\\)}\\\\n\"\\)\n        print\\(f\"  {'#':<4} {'Titulo':<42} {'Grupo':<32} {'Creado'}\"\\)\n        print\\(f\"  {'-'*4} {'-'*42} {'-'*32} {'-'*10}\"\\)\n        for i, p in enumerate\\(all_plans, 1\\):\n            print\\(f\"  {i:<4} {p['title'][:41]:<42} {p['group'][:31]:<32} {p['created']}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\n\nfrom pathlib import Path\nimport os\n\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\nSEARCH = \"gestión y visibilidad\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        # Todos los grupos sin filtro de tipo\n        url = f\"{GRAPH_BASE}/groups?$select=id,displayName,groupTypes&$top=100\"\n        groups = []\n        while url:\n            r = await client.get\\(url, headers=headers\\)\n            r.raise_for_status\\(\\)\n            data = r.json\\(\\)\n            groups.extend\\(data.get\\(\"value\", []\\)\\)\n            url = data.get\\(\"@odata.nextLink\"\\)\n\n        print\\(f\"Total grupos \\(todos los tipos\\): {len\\(groups\\)}\"\\)\n\n        found = []\n        for g in groups:\n            r = await client.get\\(f\"{GRAPH_BASE}/groups/{g['id']}/planner/plans\", headers=headers\\)\n            if r.status_code != 200:\n                continue\n            for p in r.json\\(\\).get\\(\"value\", []\\):\n                title = p.get\\(\"title\", \"\"\\)\n                if SEARCH.lower\\(\\) in title.lower\\(\\):\n                    found.append\\({\n                        \"plan_id\": p[\"id\"],\n                        \"title\": title,\n                        \"group\": g[\"displayName\"],\n                        \"group_id\": g[\"id\"],\n                        \"created\": p.get\\(\"createdDateTime\", \"\"\\)[:10],\n                        \"owner\": p.get\\(\"owner\", \"\"\\),\n                        \"created_by\": p.get\\(\"createdBy\", {}\\).get\\(\"user\", {}\\).get\\(\"id\", \"\"\\),\n                    }\\)\n\n        if not found:\n            print\\(f\"\\\\nNo se encontro ningun plan con '{SEARCH}' en el titulo.\"\\)\n        else:\n            print\\(f\"\\\\nPlanes que coinciden con '{SEARCH}':\\\\n\"\\)\n            for p in found:\n                print\\(f\"  Titulo    : {p['title']}\"\\)\n                print\\(f\"  Plan ID   : {p['plan_id']}\"\\)\n                print\\(f\"  Grupo     : {p['group']}\"\\)\n                print\\(f\"  Group ID  : {p['group_id']}\"\\)\n                print\\(f\"  Creado    : {p['created']}\"\\)\n                print\\(f\"  Creado por \\(user ID\\): {p['created_by']}\"\\)\n                print\\(\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\n\nfrom pathlib import Path\nimport os\n\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\n# Términos amplios para encontrar el plan\nKEYWORDS = [\"visibilidad\", \"corporat\", \"gestion\", \"copia\", \"copy\", \"pmo\"]\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        url = f\"{GRAPH_BASE}/groups?$select=id,displayName&$top=100\"\n        groups = []\n        while url:\n            r = await client.get\\(url, headers=headers\\)\n            r.raise_for_status\\(\\)\n            data = r.json\\(\\)\n            groups.extend\\(data.get\\(\"value\", []\\)\\)\n            url = data.get\\(\"@odata.nextLink\"\\)\n\n        all_plans = []\n        for g in groups:\n            r = await client.get\\(f\"{GRAPH_BASE}/groups/{g['id']}/planner/plans\", headers=headers\\)\n            if r.status_code != 200:\n                continue\n            for p in r.json\\(\\).get\\(\"value\", []\\):\n                title = p.get\\(\"title\", \"\"\\)\n                if any\\(kw in title.lower\\(\\) for kw in KEYWORDS\\):\n                    all_plans.append\\({\n                        \"plan_id\": p[\"id\"],\n                        \"title\": title,\n                        \"group\": g[\"displayName\"],\n                        \"created\": p.get\\(\"createdDateTime\", \"\"\\)[:10],\n                    }\\)\n\n        if not all_plans:\n            print\\(\"No se encontraron planes con esos terminos.\"\\)\n        else:\n            print\\(f\"Planes encontrados \\({len\\(all_plans\\)}\\):\\\\n\"\\)\n            for i, p in enumerate\\(all_plans, 1\\):\n                print\\(f\"  {i}. [{p['created']}] {p['title']}\"\\)\n                print\\(f\"       Grupo: {p['group']}\"\\)\n                print\\(f\"       ID:    {p['plan_id']}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\n\nfrom pathlib import Path\nimport os\n\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\nPLAN_ID  = \"4b772a19-e830-4d74-b798-b3ee980e1ac5\"\nORG_ID   = \"d00d423c-83ea-4eae-9c52-e84626c01839\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        # 1. Intentar obtener el plan directamente\n        print\\(\"=== GET /planner/plans/{id} ===\"\\)\n        r = await client.get\\(f\"{GRAPH_BASE}/planner/plans/{PLAN_ID}\", headers=headers\\)\n        print\\(f\"Status: {r.status_code}\"\\)\n        if r.status_code == 200:\n            p = r.json\\(\\)\n            print\\(f\"Titulo    : {p.get\\('title'\\)}\"\\)\n            print\\(f\"Plan ID   : {p.get\\('id'\\)}\"\\)\n            print\\(f\"Owner     : {p.get\\('owner'\\)}\"\\)\n            print\\(f\"Creado    : {p.get\\('createdDateTime', ''\\)[:10]}\"\\)\n            print\\(f\"Creado por: {p.get\\('createdBy', {}\\).get\\('user', {}\\).get\\('id', 'N/A'\\)}\"\\)\n        else:\n            print\\(f\"Respuesta : {r.text[:300]}\"\\)\n\n        # 2. Intentar obtener planes del grupo indicado en la URL\n        print\\(f\"\\\\n=== GET /groups/{ORG_ID}/planner/plans ===\"\\)\n        r2 = await client.get\\(f\"{GRAPH_BASE}/groups/{ORG_ID}/planner/plans\", headers=headers\\)\n        print\\(f\"Status: {r2.status_code}\"\\)\n        if r2.status_code == 200:\n            plans = r2.json\\(\\).get\\(\"value\", []\\)\n            print\\(f\"Planes en ese grupo: {len\\(plans\\)}\"\\)\n            for p in plans:\n                print\\(f\"  - {p.get\\('title'\\)}  [{p.get\\('id'\\)}]  creado: {p.get\\('createdDateTime',''\\)[:10]}\"\\)\n        else:\n            print\\(f\"Respuesta : {r2.text[:300]}\"\\)\n\n        # 3. Info del grupo\n        print\\(f\"\\\\n=== GET /groups/{ORG_ID} ===\"\\)\n        r3 = await client.get\\(f\"{GRAPH_BASE}/groups/{ORG_ID}?$select=id,displayName,groupTypes\", headers=headers\\)\n        print\\(f\"Status: {r3.status_code}\"\\)\n        if r3.status_code == 200:\n            g = r3.json\\(\\)\n            print\\(f\"Nombre    : {g.get\\('displayName'\\)}\"\\)\n            print\\(f\"Tipos     : {g.get\\('groupTypes'\\)}\"\\)\n        else:\n            print\\(f\"Respuesta : {r3.text[:200]}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\nfrom pathlib import Path\nimport os\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nGRAPH_BASE = \"https://graph.microsoft.com/v1.0\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        # Buscar el grupo \"Equipo TI\"\n        r = await client.get\\(\n            f\"{GRAPH_BASE}/groups?$filter=displayName eq 'Equipo TI'&$select=id,displayName\",\n            headers=headers\n        \\)\n        r.raise_for_status\\(\\)\n        groups = r.json\\(\\).get\\(\"value\", []\\)\n        if not groups:\n            print\\(\"Grupo 'Equipo TI' no encontrado.\"\\)\n            return\n        group = groups[0]\n        print\\(f\"Grupo     : {group['displayName']}\"\\)\n        print\\(f\"Group ID  : {group['id']}\"\\)\n\n        # Obtener planes del grupo\n        r2 = await client.get\\(\n            f\"{GRAPH_BASE}/groups/{group['id']}/planner/plans\",\n            headers=headers\n        \\)\n        r2.raise_for_status\\(\\)\n        plans = [p for p in r2.json\\(\\).get\\(\"value\", []\\) if \"test\" in p.get\\(\"title\",\"\"\\).lower\\(\\)]\n\n        if not plans:\n            print\\(\"No se encontro 'Test-plan' en ese grupo.\"\\)\n            return\n\n        for p in plans:\n            # Obtener creador\n            created_by_id = p.get\\(\"createdBy\", {}\\).get\\(\"user\", {}\\).get\\(\"id\", \"\"\\)\n            creator_name = \"desconocido\"\n            if created_by_id:\n                ru = await client.get\\(\n                    f\"{GRAPH_BASE}/users/{created_by_id}?$select=displayName,userPrincipalName\",\n                    headers=headers\n                \\)\n                if ru.status_code == 200:\n                    u = ru.json\\(\\)\n                    creator_name = f\"{u.get\\('displayName'\\)} \\({u.get\\('userPrincipalName'\\)}\\)\"\n\n            print\\(f\"\\\\n  Titulo    : {p['title']}\"\\)\n            print\\(f\"  Plan ID   : {p['id']}\"\\)\n            print\\(f\"  Creado    : {p.get\\('createdDateTime',''\\)[:10]}\"\\)\n            print\\(f\"  Creado por: {creator_name}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && printf \"1\\\\ns\\\\n\" | python planner_import.py --mode delete --group-id e566061f-c05d-46b9-93f4-c64dcb478370 --filter \"Test-plan\" 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python - <<'EOF'\nimport asyncio, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding='utf-8', errors='replace'\\)\nfrom pathlib import Path\nimport os\nMCP_PATH = Path\\(os.environ.get\\(\"MCP_PATH\", Path.home\\(\\) / \"mcp-servers\" / \"fornado-planner-mcp\"\\)\\)\nsys.path.insert\\(0, str\\(MCP_PATH\\)\\)\nfrom dotenv import load_dotenv\nload_dotenv\\(MCP_PATH / \".env\"\\)\nfrom src.auth.microsoft import MicrosoftAuthManager\nfrom src.config import Settings\nimport httpx\n\nPLAN_ID = \"4b772a19-e830-4d74-b798-b3ee980e1ac5\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n    headers = {\"Authorization\": f\"Bearer {token}\"}\n\n    async with httpx.AsyncClient\\(timeout=30.0\\) as client:\n        # Probar beta endpoint\n        r = await client.get\\(\n            f\"https://graph.microsoft.com/beta/planner/plans/{PLAN_ID}\",\n            headers=headers\n        \\)\n        print\\(f\"GET /beta/planner/plans/{{id}} → {r.status_code}\"\\)\n        if r.status_code == 200:\n            p = r.json\\(\\)\n            print\\(f\"  Titulo    : {p.get\\('title'\\)}\"\\)\n            print\\(f\"  Plan ID   : {p.get\\('id'\\)}\"\\)\n            print\\(f\"  Creado    : {p.get\\('createdDateTime',''\\)[:10]}\"\\)\n            etag = r.headers.get\\(\"ETag\", \"\"\\)\n            print\\(f\"  ETag      : {etag[:40]}...\"\\)\n        else:\n            print\\(f\"  {r.text[:300]}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(ls:*)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && python create_environment.py --csv templates/default_init/csv1_template.csv --dry-run 2>&1)",
      "Bash(cd \"C:\\\\Users\\\\dmorales\\\\OneDrive - Cosemar\\\\PM\\\\Automatización_procesos_MsGraph\\\\Planner_Import_script\" && python -m pytest --version 2>&1 || py -m pytest --version 2>&1 || python3 -m pytest --version 2>&1)",
      "Bash(where pytest 2>&1 && pytest --version 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -c \"import sys; print\\(sys.path\\)\" 2>&1 && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -c \"import pytest; print\\(pytest.__version__\\)\" 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -m pip install pytest pytest-asyncio --quiet 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -m pytest tests/test_create_environment.py -v 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -m pytest -v 2>&1)",
      "Skill(checkpoint)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe create_environment.py --csv templates/default_init/csv1_template.csv --dry-run 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe create_environment.py --csv templates/default_init/csv1_template.csv 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && rm -f .token_cache.json && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe create_environment.py --csv templates/default_init/csv1_template.csv 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && PYTHONUTF8=1 /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe create_environment.py --csv templates/default_init/csv1_template.csv 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && PYTHONUTF8=1 /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe - <<'EOF'\nimport asyncio, sys\nsys.path.insert\\(0, \".\"\\)\nimport planner_import  # noqa — activa dotenv + auth\nfrom planner_import import Settings, MicrosoftAuthManager, graph_request\nimport httpx\n\nGROUP_ID = \"198b4a0a-39c7-4521-a546-6a008e3a254a\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n\n    async with httpx.AsyncClient\\(timeout=60.0\\) as client:\n        # Verificar si el team ya existe\n        try:\n            data = await graph_request\\(client, \"GET\", f\"/teams/{GROUP_ID}\", token\\)\n            print\\(f\"[OK] Team ya existe: '{data.get\\('displayName'\\)}' — no se requiere accion\"\\)\n            return\n        except httpx.HTTPStatusError as exc:\n            if exc.response.status_code != 404:\n                raise\n            print\\(f\"[INFO] Team no existe para el grupo {GROUP_ID}, habilitando Teams...\"\\)\n\n        # PUT /groups/{id}/team — convierte el M365 Group en Teams team\n        result = await graph_request\\(\n            client, \"PUT\", f\"/groups/{GROUP_ID}/team\", token,\n            json={\n                \"memberSettings\": {\"allowCreateUpdateChannels\": True},\n                \"messagingSettings\": {\n                    \"allowUserEditMessages\": True,\n                    \"allowUserDeleteMessages\": True,\n                },\n                \"funSettings\": {\n                    \"allowGiphy\": True,\n                    \"giphyContentRating\": \"strict\",\n                },\n            },\n        \\)\n        print\\(f\"[OK] Team habilitado exitosamente\"\\)\n        print\\(f\"     displayName : {result.get\\('displayName', 'N/A'\\)}\"\\)\n        print\\(f\"     id          : {result.get\\('id', 'N/A'\\)}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && rm -f .token_cache.json && PYTHONUTF8=1 /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe - <<'EOF'\nimport asyncio, sys\nsys.path.insert\\(0, \".\"\\)\nimport planner_import\nfrom planner_import import Settings, MicrosoftAuthManager, graph_request\nimport httpx\n\nGROUP_ID = \"198b4a0a-39c7-4521-a546-6a008e3a254a\"\n\nasync def main\\(\\):\n    settings = Settings\\(\\)\n    auth = MicrosoftAuthManager\\(\n        tenant_id=settings.azure_tenant_id,\n        client_id=settings.azure_client_id,\n        client_secret=settings.azure_client_secret,\n    \\)\n    token = auth.get_token\\(\\)\n\n    async with httpx.AsyncClient\\(timeout=60.0\\) as client:\n        try:\n            data = await graph_request\\(client, \"GET\", f\"/teams/{GROUP_ID}\", token\\)\n            print\\(f\"[OK] Team ya existe: '{data.get\\('displayName'\\)}' — no se requiere accion\"\\)\n            return\n        except httpx.HTTPStatusError as exc:\n            if exc.response.status_code != 404:\n                raise\n            print\\(f\"[INFO] Habilitando Teams para el grupo {GROUP_ID}...\"\\)\n\n        result = await graph_request\\(\n            client, \"PUT\", f\"/groups/{GROUP_ID}/team\", token,\n            json={\n                \"memberSettings\": {\"allowCreateUpdateChannels\": True},\n                \"messagingSettings\": {\n                    \"allowUserEditMessages\": True,\n                    \"allowUserDeleteMessages\": True,\n                },\n                \"funSettings\": {\n                    \"allowGiphy\": True,\n                    \"giphyContentRating\": \"strict\",\n                },\n            },\n        \\)\n        print\\(f\"[OK] Team habilitado exitosamente\"\\)\n        print\\(f\"     displayName : {result.get\\('displayName', 'N/A'\\)}\"\\)\n        print\\(f\"     id          : {result.get\\('id', 'N/A'\\)}\"\\)\n\nasyncio.run\\(main\\(\\)\\)\nEOF\n2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe -m pytest tests/test_create_environment.py -q 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && rm -f .token_cache.json && PYTHONUTF8=1 /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe create_environment.py --csv templates/default_init/csv1_template.csv 2>&1)",
      "Bash(cd \"C:/Users/dmorales/OneDrive - Cosemar/PM/Automatización_procesos_MsGraph/Planner_Import_script\" && PYTHONUTF8=1 /c/Users/dmorales/AppData/Local/Python/pythoncore-3.14-64/python.exe tests/verify_environment.py 2>&1)",
      "Bash(cd C:\\\\Users\\\\dmorales\\\\OneDrive - Cosemar\\\\PM\\\\Automatización_procesos_MsGraph\\\\Planner_Import_script:*)"
    ]
  }
}
